a="""                                                                                                                                                                                               |         
 +-------------+                                                         +---------------------------------------------------------------------------------------------------------------------|-+       
 |             |                                                         |                                                                                                                     | |       
 +-+ +---------+ +-----------------------------------------+         +-----------------------------------------------------------------+ +-------------------------------------+               | | +---+ 
   | |           |                                         |         |   |                                                             | |                                     |               | | |   | 
 +---+     +-----|-+                                       |       +-----+           +-----+                 +-----+ +---------------+ | +-------------------------------------|---+           | | +-+ | 
 | |       |     | |                                       |       | |               |     |                 |     | |               | |                                       |   |           | |   | | 
 | |   +-------+ +-|-------+                               |       | |               |     |                 |     | |               | |           +---------+     +-----------|---+           | |   | | 
 | |   |   |   |   |       |                               |       | |               |     |                 |     | |               | |           |         |     |           |               | |   | | 
 | |   |   |   |   |       |                               |       | |               |     |             +---------+ |               +-|-----------|-------------------------------------+   +-|-|-+ | | 
 | |   |   |   |   |       |                               |       | |               |     |             |   |       |                 |           |         |     |           |         |   | | | | | | 
 | |   |   |   |   |       |                               |       | |               |     |             |   |       |                 |           |         |     |         +-|-----+ +-----|-----|-+ | 
 | |   |   |   |   |       |                               |       | |               |     |             |   |       |                 |           |         |     |         | |     | | |   | | | |   | 
 | |   |   | +-+ +---------|---------------------------------------|-|---------------|-----------------------|---+   |                 |           |         | +---|---------|---------+ |   | | | |   | 
 | |   |   | |   | |       |                               |       | |               |     |             |   |   |   |                 |           |         | |   |         | |     |   |   | | | |   | 
 | |   |   | |   | |   +-------------------------------------------------------------------------------------|-------|-----------------|---------------------|-|---|---------|-------|-----+ +-|-|-|-+ | 
 | |   |   | |   | |   |   |                               |       | |               |     |             |   |   |   |                 |           |         | |   |         | |     |   | |   | | | | | 
 | | +---+ | |   | | +---------------------------------------------|-----------------|-----|-----------------|---|---------------------|-----------------------+   |         +-----------|---------|-+ | 
 | | | | | | |   | | | |   |                               |       | |               |     |             |   |   |   |                 |           |         |     |           |     |   | |   | | |   | 
 | | | | | | |   | | | |   |                               |       | |               |     |             |   |   |   |                 |           |         |     |           |   +---+ | |   | | |   | 
 | | | | | | |   | | | |   |                               |       | |               |     |             |   |   |   |                 |           |         |     |           |   | | | | |   | | |   | 
 | | | | | | |   | +-|-----|-------------------------------------+ | |               |     +-------------------------|-----------------|-+   +---+ +-------------------------+ |   | | | | |   | | |   | 
 | | | | | | |   |   | |   |                               |     | | |               |                   |   |   |   |                 | |   |   |           |     |         | |   | | | | |   | | |   | 
 | | | | | | |   |   +-|-----------------------------------------|-|-----------------|X--------------------------|---------------------|-|---|-----+         |     |         +-|---|-|-|-|---------+   | 
 | | | | | | |   |     |   |                               |     | | |               |                   |   |   |   |                 | |   |   | |         |     |           |   | | | | |   | |     | 
 | | | | | | |   |     |   |                 +-------------------|-|-----------+     |                   |   |   |   |                 | |   |   | |         |     |         +-----|-|-----|---|---+   | 
 | | | | | | |   |     |   |                 |             |     | | |         |     |                   |   |   |   |                 | |   |   | |         |     |         | |   | | | | |   | | |   | 
 | | | | | | |   |     |   |                 |             |     | | |         |     |                   |   |   |   |   +-------------|-----|---|-----------|-----|---------|---------+ | |   | | |   | 
 | | | | | | |   |     |   |                 |             |     | | |         |     |                   |   |   |   |   |             | |   |   | |         |     |         | |   | |   | |   | | |   | 
 | | | | | | |   +-+   |   |         +---------------------------|-|-|---------|-----|-----------------------|---|-------------------+ | |   |   | |         |     |         | |   | |   | |   | | |   | 
 | | | | | | |     |   |   |         |       |             |     | | |         |     |                   |   |   |   |   |           | | |   |   | |         |     |         | |   | |   | |   | | |   | 
 | | | | | | | H +-----|---|-----------------|-------------------|-|---------+ |     |                   |   |   |   |   |           | | |   |   +-----------|-----------------|---+ |   | |   | | |   | 
 | | | | | | | | | |   |   |         |       |             |     | | |       | |     |                   |   |   |   |   |           | | |   |     |         |     |         | |     |   | |   | | |   | 
 | | | | | | | | +-|---|---|---------------+ |             |     | | |       | |     +-------------------|-------|---------------------|-----|---------------|-----------+ +---------|-+ | |   | | |   | 
 | | | | | | | |   |   |   |         |     | |             |     | | |       | |                         |   |   |   |   |           | | |   |     |         |     |     | | | |     | | | |   | | |   | 
 +---+ | | | | +-+ |   |   |         |     | |             |     | | |       | |                         |   |   |   |   |           | | |   |     |         |     |     | | | |     | | | |   | | |   | 
   |   | | | |   | |   |   |         |     | |             |     | | |       | |                         |   |   |   |   |           | | |   |     |         |     |     | | | |     | | | |   | | |   | 
 +-|-----|-|-----|-|-----------------------|---------------------|---|-------|-|-----------------------------|---+   |   |           | | |   |     |         |     |     | | | |     +---|-----|-|-|---+ 
 | |   | | | |   | |   |   |         |     | |             |     | | |       | |                         |   |       |   |           | | |   |     |         |     |     | | | |       | | |   | | |     
 | |   | | | | +---|---|---|---------------|-----------------------|-------+ +-------------------------+ |   |   +---|---------------|-------|---------------|-----|---+ | | | |       | | |   | | |     
 | |   | | | | | | |   |   |         |     | |             |     | | |     |   |                       | |   |   |   |   |           | | |   |     |         |     |   | | | | |       | | |   | | |     
 +-------|---|---|-|-+ |   |         |     | +-------------|----I|---|---------|-----------------------|-|---|---|---|---|-------------------------|-------------------|---|-|-------------+   | | |     
   |   | | | | | | | | |   |         |     |               |     | | |     |   |                       | |   |   |   |   |           | | |   |     |         |     |   | | | | |       | |     | | |     
   |   | | +-|-----|---+   |         |     |               |     | | +---------|---+                   | |   |   |   |   |     +-------|-----|---------+     |     |   | | | | |       | |     | | |     
   |   | |   | | | | |     |         |     |               |     | |       |   |   |                   | |   |   |   |   |     |     | | |   |     |   |     |     |   | | | | |       | |     | | |     
   |   | | +-----+ +---------------------------------------------|---------+   |   |                   | |   |   |   |   | +-------+ | | |   |     |   |     +-----|---+ | | | |       | |     | | |     
   |   | | | | |     |     |         |     |               |     | |           |   |                   | |   |   |   |   | |   |   | | | |   |     |   |           |     | | | |       | |     | | |     
   |   +-|-|-|-|-+   |     |         |     |               |     | |           +-----+                 | |   |   |   | +-|-----|-------|---------------|-----------------------|---------|-----|-|-+     
   |     | | | | |   |     |         |     |               |     | |               | |                 | |   |   |   | | | |   |   | | | |   |     |   |           |     | | | |       | |     | |       
   |     | | | +-+ +-+     |         |     |               | +---|-|-----------------+                 | |   |   |   | | | |   |   | | | |   |     |   |           | +---------|-------|-+     | |       
   |     | | |     |       |         |     |               | |   | |               |                   | |   |   |   | | | |   |   | | | |   |     |   |           | |   | | | |       |       | |       
   | +-------|-----|-------|-+       |     |               | |   | |           +---------+             | |   |   |   | | | |   |   | | | |   |     |   |           | |   | | | |       |       | |       
   | |   | | |     |       | |       |     |               | |   | |           |   |     |             | |   |   |   | | | |   |   | | | |   |     |   |           | |   | | | |       |       | |       
   | |   | | |     |       | |       |     |               | |   | |           |   |     |             | |   |   |   | | | |   |   | | | |   |     | +-|-----------|-|---|---|-------+ |       +---+     
   | |   | | |     |       | |       |     |               | |   | |           |   |     |             | |   |   |   | | | |   |   | | | |   |     | | |           | |   | | | |     | |         | |     
   | |   | | |   +-|-------|-|-----------------------------|---------------+   |   |     |             | |   |   |   | | | |   |   | | | |   |     | | |           | |   | | | |     | |         | |     
   | |   | | |   | |       | |       |     |               | |   | |       |   |   |     |             | |   |   |   | | | |   |   | | | |   |     | | |           | |   | | | |     | |         | |     
   | +-------|---|---------|---------|-------------------------------------|---------------------------|-----|-------|-|-|-----|---|-|-|-|-+ +-------------------+ | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |             | |   |   |   | | | |   |   | | | | |       | | |         | | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |             | |   |   |   | | | |   |   | | | | |       | | |         | | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |             | |   |   |   | | | |   |   | | | | |       | | |         | | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |             +-|---|---|-----|-|-|---|---|-|-|-|-+       | | |         | | |   | | | |     | |         | |     
   |     | | |   | |       | |       |     |               | |   | |       |   |   |     |               |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
   | +-+ | +-----------------------+ |     |               | |   | |       |   |   |     |               |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
   | | | |   |   | |       | |     | |     |               | |   | |       |   |   |     |               |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
 +-----|---+ |   | +-------|-------|-------|-----------------|---|-|---------------------+               |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
 | | | | | | |   |         | |     | |     |               | |   | |       |   |   |                     |   |   |   | | | |   |   | | | |         | | |         | | |   | | | |     | |         | |     
 | | | | | | |   |     +---|---------------|-----------------|-----|-----------|---------+               |   |   |   | | | |   |   | | | | +-------|-|-----+     | | |   | | | |     | |         | |     
 | | | | | | |   |     |   | |     | |     |               | |   | |       |   |   |     |               |   |   |   | | | |   |   | | | | |       | | |   |     | | |   | | | |     | |         | |     
 | | | | | | |   |     |   | +-------|-----------------------|-----|---------------|-----|-------------------|-----------+ |   |   | | | | |       | | |   |     | | +---|-+ | |     | |       +-|-----+ 
 | | | | | | |   |     |   |       | |     |               | |   | |       |   |   |     |               |   |   |   | |   |   |   | | | | |       | | |   |     | |     |   | |     | |       | | |   | 
 | | | | +-|-|---------+   +-+     | |     |               | |   | |     +-|---|---|---------------+     |   |   |   | |   |   |   | | | | |       | | |   |     | |     |   | |     | | +---------|-+ | 
 | | | |   | |   |           |     | |     |               | |   | |     | |   |   |     |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |     |   | |     | | |     | | | | | 
 | | | | +-------+         +---------|-----------+         | |   | |     | |   |   +---------------|-------------------|---|---|---|-|-|-----------|-|-|---------|-|---+ |   | |     | | |     | | | | | 
 | | | | | | |             | |     | |     |     |         | |   | |     | |   |         |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |   | |   | |     | | |     | | | | | 
 | | | | | | |             | |     | |     |     |         | |   | |     | |   |         |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |   | |   | |     | | |     | | | | | 
 | | | | | | |             | |     | |     |     |         | |   | |     | |   |         |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |   | |   | |     | | |     | | | | | 
 | | | | | | |         +-----|-----|-|---------------------|-----|-------|-----------------------------------|---|---|-|-----------|-|-|-|-------------|-----------|---|-----|-----+ +-------+ | | | | | 
 | | | | | | |         |   | |     | |     |     |         | |   | |     | |   |         |         |     |   |   |   | |   |   |   | | | | |       | | |   |     | |   | |   | |   |   | |   | | | | | | 
 | | | | | | |         |   | | +---|-------|-----|---------------|---------+   |         |         |     |   |   +---|-------------|-----|---------|-------|-----+ |   | |   | |   |   | |   | | | | | | 
 | | | | | | |         |   | | |   | |     |     |         | |   | |     |     |         |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | | | | | 
 | | | | | | | +-+     |   | +-|-----------|---------------|-|---|-|-----|-------------------------------|---|---------|-----------|-|-|-|-|-----------|---------------|-|---|-----------|---------|-+ | 
 | | | | | | | | |     |   |   |   | |     |     |         | |   | |     |     |         |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | | |   | 
 | | | | | | | | |     | +-----|-----|-----|-----+         | |   | |     |     |         |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | | |   | 
 | | | | | | | | |     | | |   |   | |     |               | |   | |     |     |         |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | | |   | 
 | +-|---|-|-|-|---------------------------|-----------------|-----|-----|-----------+   |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | | +-|-+ | 
 |   | | | | | | |     | | |   |   | |     |               | |   | |     |     |     |   |         |     |   |       | |   |   |   | | | | |       | | |   |       |   | |   | |   |   | |   | |   | | | 
 +---|-----|---|-------+ | |   | +-----+   |               | |   | |     |     |     |   |         |     |   |       | |   |   |   | | | | +-------|---|---|-----------|-------|-----+ | |   | |   | | | 
     | | | | | | |       | |   | | | | |   |               | |   | |     |     |     |   |         |     |   |       | |   |   |   | | | |         | | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | |       | |   | | | | |   |               | |   | |     |     |     |   |         |     |   |       | | +-----|---------|---------+ | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | |       | |   | | | | |   |               | |   | |     |     |     |   |         |     |   |       | | | |   |   | | | |           | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | | +-----|-----|---|-|-|---------------------|-----------------------|---|---------|---------|-------|-----|-------|-|-|---------+   | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | | |     | |   | | | | |   |               | |   | |     |     |     |   |         |     |   |       | | | |   |   | | | |       |   | |   |       |   | |   | |   | | | |   | |   | | | 
     | | | | | | | |     | |   | | | | | +---+             | |   | |     |     |     |   |         |     |   |       | | | |   |   | | | |       |   | |   |       |   | |   | +---------+   | |   | | | 
     | | | | | | | |     | |   | | | | | | | |             | |   | |     |     |     |   |         |     |   |       | | | |   |   | | | |       |   | |   |       |   | |   |     | | |     | |   | | | 
     | +-|---|-|---------|-----|---|-|---+ | |             | |   | |     |     |     | +-----------+     |   |       | | | |   |   | | | |       |   | +-----------------|---|-+   | +-|---+ | |   | | | 
     |   | | | | | |     | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | +-|-------+ +---+ | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       | | | |   |   | | | |       |   |     |       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |       +-|-|-|---|---|-|-|-------------|-----+       |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |         | | |   |   | | | |       |   |             |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |         | | +---+   | | | |       |   |             |   | |   | |   |   |   | | |   | | | 
     | | | | | |       | | |   | | | | |   | |             | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   | |   | |   |   |   | | |   | | | 
 +---|-------|---------+ +-----|-|-|---|---|-|---+         | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   | +-+ | |   |   |   | | |   | | | 
 |   | | | | | |           |   | | | | |   | |   |         | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   |   | | |   |   |   | | |   | | | 
 |   | +-|-----------+     |   | | | | |   | |   |         | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   |   | | +-------|-----|-|-------+ 
 |   |   | | | |     |     |   | | | | |   | |   |         | |   | |     |     |     | | |               |   |         | |         | | | |       |   |             |   |   | |     |   |   | | |   | |   
 |   |   | | | |     |     |   | | | | |   | |   |         | |   | |     |     |     | | |   +---------------------------|---------|---|-------------|-----------------|-+ | |     |   |   | | | +-|-|-+ 
 |   |   | | | |     |     |   | | | | |   | |   |         | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |     |   |   | | | | | | | 
 |   | +---|---|-+   |     |   | | | | |   | |   |       +-------|-|-----|-----|---------------------------------------|-|-----------|-|---------|---|--N----------------|---------|---------|-----|---+ 
 |   | | | | | | |   |     |   | | | | |   | |   |       | | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |     |   |   | | | | | |   
 |   | | | | | | |   |     | +---|---------|-|-----------|---------|-----|-----------|-|-----|-----------|-------------|-|---------|-------------|---------------------|---|-|---+ |   |   | | | | | |   
 |   | | | | | | |   |     | | | | | | |   | |   |       | | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |   | |   |   | | | | | |   
 +-------+ | | | |   |     | | | | | | |   | |   |       | | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |   | |   |   | | | | | |   
     | |   | | | |   |     | | | | | | |   | |   |       | | |   | |     |     |     | | |   |           |   |         | |         | | | |       |   |             |   | | | |   | |   |   | | | | | |   
 +---|-+   | | | |   |     | | | | | | |   | |   |       +-------|-------------|-----|---|---|---------------|-----------|-------------|---------|---+             |   | | | |   | |   |   | | | | | |   
 |   |     | | | |   |     | | | | | | |   | |   |         | |   | |     |     |     | | |   |           |   |         | |         | | | |       |                 |   | | | |   | |   |   | | | | | |   
 | +-------|-----|---|-----|-|---------------|---------------|---|-------|-----------|---|-------------------|---------|-----------|-|-|-------------------------------------------|---|-------------|-+ 
 | | |     | | | |   |     | | | | | | |   | |   |         | |   | |     |     |     | | |   |           |   |         | |         | | | |       |                 |   | | | |   | |   |   | | | | | | | 
 | | |     | | | |   |   +-+ +-|-|-|---------|---|---------|-|-----|-----|-----+     | | |   |           |   |         | |         | | | |     +-----+             |   | | | |   | |   |   | | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |         | |   | |     |           | | |   |           |   |         | |         | | | |     | |   |             |   | | | |   | |   |   | | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |       +---|---|-|-------------------|-----|---------------|---------|-|---------------|-------|-----------------|-----|-|-|---|-|-------+ | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |       | | |   | |     |           | | |   |           |   |         | |         | | | |     | |   |             |   | | | |   | |   |     | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |       | | |   | |     |       +---+ | |   |           |   |         | |         | | | |     | |   |             |   | | | |   | |   |     | | | | | | 
 | | |     | | | |   |   |     | | | | |   | |   |       | | |   | |     |       |     | |   |           |   |         | |         | | | |     | |   |             |   | | | |   | |   |     | | | | | | 
 | | |     | | | |   |   |     | | +-|-|---+ |   |       | | |   | |     |       |     | |   |           |   |         | |     +---|-|----Y------------------------|---|-|---|---+ |   |     | | | | | | 
 | | |     | | | |   |   |     | |   | |     |   |       | | |   | |     |       |     | |   |           |   |         | |     |   | | | |     | |   |             |   | | | |     |   |     | | | | | | 
 | | |     +-|-|-----|-----------|---|-------------------|-|-+   | |     |       |     | |   |           |   |         | |     +-----|-|-|---------------------------------|-------|---|-+   | | | | | | 
 | | |       | | |   |   |     | |   | |     |   |       | |     | |     |       |     | |   |           |   |         | |         | | | |     | |   |             |   | | | |     |   | |   | | | | | | 
 | | +---------|-|-------|-----------|-|-----|---|-------|---------|-----|-------|-------+   |           |   |         +-|-------+ | | | |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |         | | |   |   |     | |   | |     |   |       | |     | |     |       |     |     |           |   |           |       | | | | |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |         | | |   |   |     | |   | |     |   |       | +---+ | |     |       |     +-----------------|---------------|-----------|-|-|-----|-|---|-------------|---|-|-|-------|---------|-+ | | | | 
 | |         | | |   |   |     | |   | |     |   |       |     | | |     |       |           |           |   |           |       | | | | |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |     +-------|---|---------------|-------------------|-----+ | |     |       |     +-+   |           |   |         +---------|-|-|-+ |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |     |   | | |   |   |     | |   | |     |   |       |       | |     |       |     | |   |           |   |         | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |     |   | | |   |   |     | |   | |     |   |       |       | |     |       |     +-|---------------|---|-----+   | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |     |   | | |   |   |     | |   | |     |   |       |       | |     |       |       |   |           |   |     |   | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   +-|-----------|-----+   | |   | |     |   |       |       | |     |       |       |   |           |   |     |   | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   | |   | | |   |   | |   | |   | |     |   |       |       | |     |       |       |   |           |   |     |   | |       | | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   | |   | | |   |   | |   | |   | +-----------------|-------|-|-----|-------------------------------|---|-----|---|---------+ | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   | |   | | |   |   | |   | |   |       |   |       |       | |     |       |       |   |           |   |     |   | |         | |   |     | |   |             |   | | | |     |   | |   |   | | | | 
 | |   | |   | | |   |   | |   | |   |     +-|---|-------|-------|-|-----------------------------------------------|---|-----------------|-------------------------|---------|---------|-|-----+ | | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |           |   |     |   | |         G |   |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |           +---|---------------------|-|-+ |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |         | | | |     | |   |             |   | | | |     |   | |   | | | | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |         | | | |     | |   +-----------------|-----------|---|-----|-|-+ | | | 
 | |   | |   | | |   |   | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |         | | | |     | |                 |   | | | |     |   | |   | |   | | | 
 | |   | |   | +-----|-+ | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |     +-+ | | | | +---------------------+ |   | | | |     |   | |   | |   | | | 
 | |   | |   |   |   | | | |   | |   |     | |   |       |       | |     |       |       |   |               |     |   | |     | | | | | | |   | |               | |   | | | |     |   | |   | |   | | | 
 | |   | |   | +---------|-|---------------|-----------------------------|---------------|---|-------------------+ |   | |     | | | | | | | +-|-|-----------------|---|-|---------+   | +-----|-+ | | | 
 | |   | |   | | |   | | | |   | |   |     | |   |       |       | |     |       |       |   |               |   | |   | |     | | | | | | | | | |               | |   | | | |         |     | | | | | | 
 | |   | |   | | |   | | | |   | |   |     | |   |       |       | |     |       |       |   |               |   | +---|---------|-|-+ | | | | | |               | |   | | | |     +-----+   | | | | | | 
 | |   | |   | | |   | | | |   | |   |     | |   |       |       | |     |       |       |   |               |   |     | |     | | |   | | | | | |               | |   | | | |     |   | |   | | | | | | 
 | | +---------|-----|---|-+   | |   |     | |   |       |       | |     |       |       |   |               |   |     | |     | | |   | | | | | |               | |   | | | |     |   | +-----|-+ | | | 
 | | | | |   | | |   | | |     | |   |     | |   |       |       | |     |       |       |   |               |   |     | |     | | |   | | | | | |               | |   | | | |     |   |     | |   | | | 
 | | | | |   | | |   | | |     | |   |     | +-----------+       | |     |       |       |   |               |   |     +-|-+   | | |   | | | | | |               | |   | +-|-|-----|---|-+   | |   | | | 
 | | | | |   | | |   | | |     | |   |     |     |               | |     |       |       |   |               |   |       | |   | | |   | | | | | |               | |   |   | |     |   | |   | |   | | | 
 | | +---|-+ | | |   | | |     | |   |     +-----|-----------------------|---------------|-------------------------------|-|---|-------|-+ | +-|-|---------------|-|-------|-|---+ |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |               |   |       | |   | | |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |           +-------|---------------+ |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |           |   |   |       | |   |   |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |           |   |   |       | |   |   |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               | |     |       |       |   |           |   |   |       | |   |   |   |   |   | |               | |   |   | |   | |   | |   | |   | | | 
 | |   | | | | | |   | | |     | |   |           |               +---------------------------|---------------|---|-------|-|-----------|-------------------------|-|---------|-----|---|-----|-|-----+ | 
 | |   | | | | | |   | | |     | |   |           |                 |     |       |       |   |           |   |   |       | |   |   |   |   |   | |               | |   |   | |   | |   | |   | |   |   | 
 | |   | | | +-----+ | | | +---------|-------------------+         +-----+       |       |   |           |   |   |       | |   |   |   |   +--W|-|---------------|-|---|-------+ | +---|-+   | |   |   | 
 | |   | | |   | | | | | | |   | |   |           |       |                       |       |   |           |   |   |       | |   |   |   |       | |               | |   |   | | | |     |     | |   |   | 
 | |   | | |   | | | | | | |   | |   |           |       |         +-------------------------------------+   |   |       | |   |   |   |       | |               | |   |   | | | +-------+   | |   |   | 
 | |   | | |   | | | | | | |   | |   |           |       |         |             |       |   |               |   |       | |   |   |   |       | |               | |   |   | | |       | |   | |   |   | 
 | |   | | |   | | | | | | |   | |   | +-----+   |       |         +-------------|-------------------------------|---------|---|---------------|-|---------------|-|---+   +-+ |       | |   | |   |   | 
 | |   | | |   | | | | | | |   | |   | |     |   |       |                       |       |   |               |   |       | |   |   |   |       | |               | |           |       | |   | |   |   | 
 | |   | | |   | | +-------|---+ |   | +-------------+   |                   +-----------+   |               |   +---+   | +---|-+ |   |       | |               | |           |       | |   | |   |   | 
 | |   | | |   | |   | | | |     |   |       |   |   |   |                   |   |           |               |       |   |     | | |   |       | |               | |           |       | |   | |   |   | 
 +-|---|-|-|---|-----|-|-|-----------------------|---|---|-----------------------|-----------|-----------------------|---------|---|-----------|-|-----------------|---------+ |       | |   | |   |   | 
   |   | | |   | |   | | | |     |   |       |   |   |   |                   |   |           |               |       |   |     | | |   |       | |               | |         | |       | |   | |   |   | 
   | +-|---|---------------+ +-------------------|---+   |                   |   |           |               +-------|---|-----|-----------------|-----------------+         | |       | |   | |   |   | 
   | | | | |   | |   | | |   |   |   |       |   |       |                   |   |           |                       |   |     | | |   |       | |               |           | |       | |   | |   |   | 
   | | | | +---------|-----+ |   |   |       |   |       |                   |   |           |                       |   |     | | |   |       | |               |           | |       | |   | |   +---+ 
   | | | |     | |   | | | | |   |   |       |   |       |                   |   |           |                       |   |     | | |   |       | |               |           | |       | |   | |         
   | | +---+   | | +---+ +---|------K--------|-------------------------------|---------------|-----------------------|---|-------------|---------|---+           |           | |       | |   | |         
   | |   | |   | | | |     | |   |   |       |   |       |                   |   |           |                       |   |     | | |   |       | |   |           |           | |       | |   | |         
 +---|---|-+   +-|-----+ +-+ +-+ +---|-------------------------------------------|---------------------------------------------|---|-----------|-----|---------+ |   +-------|-+       | |   +---+       
 | | |   |       | | | | |     |     |       |   |       |                   |   |           |                       |   |     | | |   |       | |   |         | |   |       |         | |     | |       
 | +-|---|-------+ | | | |     |     |     +-|-----------|-------------------+   |           |               +-----------|-------|-|-------------+   |         | |   |       |         | +---+ | |       
 |   |   |         | | | |     |     |     | |   |       |                       |           |               |       |   |     | | |   |       |     |         | |   |       |         O     | | |       
 |   |   | +---------|-|-|-----------|-----|-|---|-------------------------------+           |               +-----------+     | +-|---|-------+ +---+         | |   |       |         |     | | |       
 |   |   | |       | | | |     |     |     | |   |       |                                   |                       |         |   |   |         |             | |   |       |         |     | | |       
 +---|---|-------+ | | | |   +-------|-------|-----------------------------------------------|-----------------------|-------------|---|---------+             +-------------|---------+     +---------+ 
     |   | |     | | | | |   | |     |     | |   |       |                                   |                       |         |   |   |                         |   |       |                 | |     | 
     |   | +-----|---|---------|-----|-----------------------------------------------------------------------------------------|---------------------------------+ +-+       |                 | |     | 
     |   |       | | | | |   | |     |     | |   |       |                                   |                       |         |   |   |                           |         |                 | |     | 
     |   |       | | | | +---|-+     | +-----|---|-------+                                   +-----------------------+         |   |   +---------------------------+         +---------------+ +-+     | 
     |   |       | | | |     |       | |   | |   |                                                                             |   |                                                         |         | 
     | +-+       +-+ | |     |       | |   +-+   |       +---------------------------------------------------------------------------------------------------------------------------------------------+ 
     | |             | |     |       | |         |       |                                                                     |   |                                                         |           
     +-+             +-+     +-------+ +---------+       +---------------------------------------------------------------------+   +---------------------------------------------------------+           
                                                                                                                                                                                                         
                                                                                                                                                                                                         """
test="""     |          
     |  +--+    
     A  |  C    
 F---|----E|--+ 
     |  |  |  D 
     +B-+  +--+ 
                """
#a=test
b=[x for x in a.splitlines()]

def camera(c):
    i,j = c
    start,end = 0,len(b)-1
    if 0 <= j-2 < len(b): start = j-2
    if 0 <= j+3 < len(b): end = j+3
    for jj,yy in enumerate(b[start:end]):
        start,end = 0,len(b[0])-1
        if 0 <= i-2 < len(b[0]): start = i-2
        if 0 <= i+3 < len(b[0]): end = i+3
        print("".join(yy[start:end]))
    print()

allLetters = []
for j,y in enumerate(b):
    for i,x in enumerate(y):
        if x in [chr(z) for z in range(65,91)]: 
            allLetters.append(x)
            camera((i,j))

dirs=[(0,1),(-1,0),(0,-1),(1,0)] #down left right up
dir=0
y=0
x=[i for i in range(len(b[0])) if b[0][i]=="|"][0]
result = []
steps=1
while True:
    if len(result)==len(allLetters): break
    steps+=1
    #print((x,y))
    #camera((x,y))
    dx,dy=dirs[dir]
    x,y = x+dx,y+dy
    val = b[y][x]
    if val in [chr(z) for z in range(65,91)]: result.append(val)
    if val == "+":
        newDirs = [(dir+1)%4,(dir-1)%4]
        for newDir in newDirs:
            dx,dy = dirs[newDir]
            if b[y+dy][x+dx] != " ": 
                dir = newDir
                break
    #print(val)
print("".join(result))#part1
print(steps)#part2